"use strict";var AppSettings={appTitle:"Example Application",apiUrl:"http://localhost:3000"},app=angular.module("myApp",["myApp.dashboard","myApp.auth"]);app.config(["$locationProvider","$stateProvider","$urlRouterProvider",function(t,o,a){t.hashPrefix("!"),a.otherwise("/dashboard")}]),app.constant("AppSettings",AppSettings),app.factory("requestHeaders",function(){return function(){return{"X-USER-EMAIL":localStorage.email,"X-USER-TOKEN":localStorage.token}}}),app.run(["$rootScope","AppSettings",function(t,o){t.pageTitle=o.appTitle,localStorage.token?console.log("The user is logged in."):$location.path("/login")}]),angular.module("myApp.dashboard",["ui.router"]).config(["$stateProvider",function(t){t.state("dashboard",{url:"/dashboard",templateUrl:"/components/dashboard/dashboard.html",controller:"DashboardCtrl"})}]).controller("DashboardCtrl",[function(){}]);var authApp=angular.module("myApp.auth",[]);authApp.controller("AuthenticationCtrl",["$scope","$http","$location","AppSettings","StoreLoginData",function(t,o,a,e,n){t.go=function(t){a.path(t)};var r=e.apiUrl;t.registerUser=function(a,e,n,s,i){var l={user:{first_name:a,last_name:e,email:n,password:s,password_confirmation:i}};o({method:"POST",url:r+"/users.json",data:l}).then(function(o){t.loginUser(n,s)},function(o){t.registrationStatus=-1})},t.loginUser=function(e,s){var i={user:{email:e,password:s}};o({method:"POST",url:r+"/users/sign_in.json",data:i}).then(function(t){n(e,t.data.authentication_token),a.path("/dashboard")},function(o){t.loginStatus=-1})},t.forgotPassword=function(a){o({method:"GET",url:r+"/send_password.json?user_email="+a}).then(function(o){t.emailSent=1},function(o){t.emailSent=-1})},t.resetPassword=function(e,n){var s=a.search().reset_password_token;o({method:"PUT",url:r+"/users/password.json",data:{user:{password:e,confirm_password:n,reset_password_token:s}}}).then(function(t){a.search("reset_password_token",null),a.path("/login")},function(o){t.resetStatus=-1})}}]),authApp.factory("Logout",["$window","$location","$http","AppSettings",function(t,o,a,e){var n=e.apiUrl;return function(){a({headers:{"X-USER-EMAIL":localStorage.email,"X-USER-TOKEN":localStorage.token},method:"DELETE",url:n+"/users/sign_out.json"}).then(function(t){delete localStorage.email,delete localStorage.token,o.path("/login")})}}]),authApp.factory("StoreLoginData",function(){return function(t,o){localStorage.email=t,localStorage.token=o}}),authApp.config(["$stateProvider",function(t){t.state("login",{url:"/login",templateUrl:"/components/authentication/login.html",controller:"AuthenticationCtrl"}).state("signup",{url:"/sign_up",templateUrl:"/components/authentication/sign_up.html",controller:"AuthenticationCtrl"}).state("forgotpassword",{url:"/forgot_password",templateUrl:"/components/authentication/forgot_password.html",controller:"AuthenticationCtrl"}).state("resetpassword",{url:"/reset_password",templateUrl:"/components/authentication/reset_password.html",controller:"AuthenticationCtrl"})}]);